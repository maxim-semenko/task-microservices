version: '3.3'
services:

  eureka-server:
    image: my-app/eureka-server:latest
    container_name: eureka-server
    ports:
      - "8761:8761"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
    networks:
      - spring

  rabbitmq:
    ports:
      - '15673:15672'
      - '5673:5672'
    volumes:
      - '/C//rabbitmq/data:/var/lib/rabbitmq/mnesia'
    container_name: rabbitmq
    environment:
      - RABBITMQ_DEFAULT_USER=user
      - RABBITMQ_DEFAULT_PASS=password
    image: 'rabbitmq:3-management'
    networks:
      - spring

  postgres:
      container_name: 'postgres'
      image: 'postgres'
      environment:
        - POSTGRES_USER=user
        - POSTGRES_PASSWORD=password
        - PGDATA=/data/postgres
      volumes:
        - 'postgres:/data/postgres'
      ports:
        - '5431:5432'
      networks:
        - 'postgres'
      restart: unless-stopped

  pgadmin:
      container_name: 'pgadmin'
      image: 'dpage/pgadmin4'
      environment:
        PGADMIN_DEFAULT_EMAIL: ${PGADMIN_DEFAULT_EMAIL:-pgadmin4@pgadmin.org}
        PGADMIN_DEFAULT_PASSWORD: ${PGADMIN_DEFAULT_PASSWORD:-admin}
        PGADMIN_CONFIG_SERVER_MODE: 'False'
      volumes:
        - 'pgadmin:/var/lib/pgadmin'
      ports:
        - '5050:80'
      networks:
        - 'postgres'
      restart: 'unless-stopped'

networks:
  postgres:
    driver: bridge
  spring:
    driver: bridge

volumes:
  postgres:
  pgadmin: